<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>LLM Fine-Tuning Playground (Gemini)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
body{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;
background:#f6f8fb;margin:0;color:#1f2937}
header{background:#111827;color:#fff;padding:16px 24px}
header h1{margin:0;font-size:20px}
.container{max-width:1200px;margin:auto;padding:16px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media(max-width:900px){.grid{grid-template-columns:1fr}}
.card{background:#fff;border-radius:8px;padding:16px;
box-shadow:0 2px 8px rgba(0,0,0,.05)}
h2{font-size:16px;margin-top:0}
label{font-size:14px;font-weight:500;display:block;margin-top:10px}
input,select,textarea,button{width:100%;padding:8px;margin-top:6px;
border-radius:6px;border:1px solid #d1d5db;font-size:14px}
textarea{min-height:90px}
button{background:#2563eb;color:#fff;font-weight:600;border:none;cursor:pointer;margin-top:12px}
button:disabled{background:#9ca3af;cursor:not-allowed}
.row{display:flex;gap:10px;align-items:center;margin-top:8px}
.status{font-size:13px}
.success{color:#059669}
.error{color:#dc2626}
.slider-row{display:grid;grid-template-columns:1fr 70px;gap:8px;align-items:center}
.output{background:#0f172a;color:#e5e7eb;padding:14px;border-radius:6px;
min-height:180px;white-space:pre-wrap;font-family:ui-monospace,monospace;font-size:13px}
.hint{font-size:12px;color:#6b7280;margin-top:4px}
footer{margin-top:24px;padding:16px;background:#fff;border-radius:8px;font-size:14px;line-height:1.6}
footer h3{margin-top:0}
.mode-group label{display:flex;align-items:center;gap:8px;cursor:pointer}
</style>
</head>
<body>

<header>
  <h1>LLM Fine-Tuning Playground (Gemini)</h1>
</header>

<div class="container">

<div class="card">
  <h2>üîê Gemini API Key Setup</h2>
  <input id="apiKey" placeholder="Paste Gemini API key"/>
  <div class="row">
    <button onclick="validateKey()">Validate API Key</button>
    <span id="apiStatus" class="status"></span>
  </div>
  <div class="hint">API key is used only in this browser session.</div>
</div>

<div class="grid">

<div class="card">
  <h2>üß† Model Selection</h2>
  <select id="modelSelect" disabled></select>
  <div class="hint" id="modelHint">Validate API key to load models.</div>
</div>

<div class="card">
  <h2>üé≠ Response Style</h2>
  <div id="modes" class="mode-group"></div>
</div>

</div>

<div class="grid">

<div class="card">
  <h2>üéõÔ∏è Model Controls</h2>

  <label>Temperature</label>
  <div class="slider-row">
    <input type="range" id="temperature" min="0" max="1.5" step="0.1">
    <input type="number" id="temperatureVal" step="0.1">
  </div>
  <div class="hint">Controls creativity.</div>

  <label>Top-P</label>
  <div class="slider-row">
    <input type="range" id="topP" min="0" max="1" step="0.05">
    <input type="number" id="topPVal" step="0.05">
  </div>
  <div class="hint">Probability mass sampling.</div>

  <label>Top-K</label>
  <div class="slider-row">
    <input type="range" id="topK" min="1" max="100" step="1">
    <input type="number" id="topKVal" step="1">
  </div>
  <div class="hint">Max token choices.</div>

  <label>Max Output Tokens</label>
  <input type="number" id="maxTokens" value="512" min="50" max="2048">
</div>

<div class="card">
  <h2>üß† Instruction & Prompt</h2>

  <label>System / Instruction Prompt</label>
  <textarea id="systemPrompt"></textarea>

  <label>User Prompt</label>
  <textarea id="userPrompt" placeholder="Ask something..."></textarea>

  <button id="runBtn" onclick="runPrompt()" disabled>Run Prompt</button>
</div>

</div>

<div class="card">
  <h2>üì§ Model Output</h2>
  <div id="output" class="output">Waiting for input‚Ä¶</div>
  <div id="meta" class="hint"></div>
</div>

<footer>
  <h3>üìò Understanding Fine-Tuning</h3>
  In this playground you are doing <strong>inference tuning</strong> ‚Äî adjusting behavior per request.<br><br>
  <strong>Fine-tuning</strong> retrains the model on new data permanently.<br><br>
  Temperature controls creativity. Top-P and Top-K control how many words the model can consider.<br><br>
  This tool helps you feel these differences hands-on.
</footer>

</div>

<script>
const modes = {
  "Innovative Thinker": {temperature:1.2, topP:0.95, topK:60,
    system:"You are an innovative thinker who explores bold, creative ideas and unconventional perspectives."},
  "Factual & Precise": {temperature:0.2, topP:0.7, topK:20,
    system:"You answer factually, precisely, and avoid speculation or unnecessary verbosity."},
  "Funny Kid": {temperature:0.9, topP:0.9, topK:50,
    system:"You explain things like a funny 9-year-old kid using simple words, humor, and playful examples."},
  "Product Manager": {temperature:0.4, topP:0.8, topK:30,
    system:"You are a seasoned product manager. Be structured, practical, and decision-oriented."},
  "No-Nonsense": {temperature:0.1, topP:0.6, topK:15,
    system:"Give blunt, direct, no-nonsense factual answers. No fluff."},
  "Custom": {temperature:0.7, topP:0.9, topK:40, system:""}
};

const modesDiv = document.getElementById("modes");

Object.keys(modes).forEach((mode, idx) => {
  const label = document.createElement("label");
  label.innerHTML = `<input type="radio" name="responseMode" value="${mode}" ${idx===0?"checked":""}> ${mode}`;
  modesDiv.appendChild(label);
});

function applyMode(modeName){
  const cfg = modes[modeName];
  temperature.value = temperatureVal.value = cfg.temperature;
  topP.value = topPVal.value = cfg.topP;
  topK.value = topKVal.value = cfg.topK;
  systemPrompt.value = cfg.system;
}

document.querySelectorAll('input[name="responseMode"]').forEach(radio => {
  radio.addEventListener("change", e => applyMode(e.target.value));
});

function sync(a,b){a.oninput=()=>b.value=a.value;b.oninput=()=>a.value=b.value}
sync(temperature,temperatureVal);
sync(topP,topPVal);
sync(topK,topKVal);

applyMode(document.querySelector('input[name="responseMode"]:checked').value);

let apiValid=false;

async function validateKey(){
  apiStatus.textContent="Validating‚Ä¶";
  try{
    const res=await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${apiKey.value}`);
    if(!res.ok) throw new Error();
    const data=await res.json();
    modelSelect.innerHTML="";
    data.models.filter(m=>m.supportedGenerationMethods?.includes("generateContent"))
      .forEach(m=>{
        const o=document.createElement("option");
        o.value=m.name;o.textContent=m.name;
        modelSelect.appendChild(o);
      });
    modelSelect.disabled=false;
    apiStatus.textContent="API Key Valid ‚úÖ";
    apiStatus.className="status success";
    runBtn.disabled=false;
    apiValid=true;
  }catch{
    apiStatus.textContent="Invalid API Key ‚ùå";
    apiStatus.className="status error";
  }
}

async function runPrompt(){
  if(!apiValid) return;
  output.textContent="Thinking‚Ä¶";
  const start=performance.now();
  const body={
    contents:[{role:"user",parts:[{text:systemPrompt.value+"\n\n"+userPrompt.value}]}],
    generationConfig:{
      temperature:+temperature.value,
      topP:+topP.value,
      topK:+topK.value,
      maxOutputTokens:+maxTokens.value
    }
  };

  const fallbackModels=[modelSelect.value,"models/gemini-1.5-flash","models/gemini-1.0-pro"];

  for(const model of fallbackModels){
    try{
      const res=await fetch(
        `https://generativelanguage.googleapis.com/v1beta/${model}:generateContent?key=${apiKey.value}`,
        {method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(body)}
      );
      if(!res.ok) throw new Error();
      const data=await res.json();
      output.textContent=data.candidates?.[0]?.content?.parts?.[0]?.text || "No response.";
      meta.textContent=`Used model: ${model} ‚Ä¢ Latency: ${Math.round(performance.now()-start)} ms`;
      return;
    }catch(e){}
  }
  output.textContent="All models failed. Check quota or billing.";
}
</script>

</body>
</html>
